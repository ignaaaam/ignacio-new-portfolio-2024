---
import { getLangFromUrl } from "../i18n/utils";
import FAQSchema from "./FAQSchema.astro";

const lang = getLangFromUrl(Astro.url);
const isEnglish = lang === "en";

const title = isEnglish ? "Frequently Asked Questions" : "Preguntas Frecuentes";

const description = isEnglish ? "Find answers to common questions about my services, process, and expertise." : "Encuentra respuestas a preguntas comunes sobre mis servicios, proceso y experiencia.";

const questionsEN = [
  {
    question: "What type of roles are you looking for?",
    answer:
      "I'm open to full-time remote positions, long-term contracts, and team augmentation roles. I'm looking for a product-focused team where I can contribute as a full stack developer using PHP, Laravel, and Vue.js. I'm also open to contract work for companies that need a reliable developer for specific projects or sprints.",
  },
  {
    question: "Can you work in different time zones?",
    answer:
      "Yes. I'm based in Barcelona (CET/CEST) and have experience collaborating with teams across Europe and the Americas. I'm flexible with my schedule and can adapt to overlap hours with your team. I've worked successfully with distributed teams and understand the importance of async communication.",
  },
  {
    question: "What does your ideal team or project look like?",
    answer:
      "I thrive in product-focused teams that value clean code, code review, and continuous improvement. I enjoy working with teams that use modern development practices like Git flow, CI/CD, and agile methodologies. I'm most effective when I can own features end-to-end, from database to UI, and collaborate closely with designers and product managers.",
  },
  {
    question: "How do you handle remote communication?",
    answer:
      "I keep daily async updates, stay available on Slack or Teams during overlap hours, and document my work clearly. I'm proactive about flagging blockers early, asking questions when requirements are unclear, and sharing progress updates. I've been working remotely since 2019 and have refined a workflow that keeps teams aligned without unnecessary meetings.",
  },
  {
    question: "What's your onboarding process like?",
    answer:
      "I typically get productive within the first week. I start by reading existing documentation, understanding the codebase architecture, and setting up the local development environment. I prefer to pick up a small task early to get familiar with the code review process and team conventions. By week two, I'm usually contributing to regular sprint work.",
  },
  {
    question: "Are you open to on-site or hybrid work?",
    answer:
      "I prefer fully remote work, but I'm open to occasional on-site visits or hybrid arrangements within Europe. I believe the best work happens when developers have the flexibility to focus without interruptions, combined with periodic in-person collaboration for team bonding and strategic planning.",
  },
];

const questionsES = [
  {
    question: "¿Qué tipo de posiciones buscas?",
    answer:
      "Estoy abierto a posiciones remotas a tiempo completo, contratos a largo plazo y roles de refuerzo de equipo (team augmentation). Busco un equipo enfocado en producto donde pueda contribuir como desarrollador full stack con PHP, Laravel y Vue.js. También estoy disponible para contratos con empresas que necesiten un desarrollador fiable para proyectos o sprints específicos.",
  },
  {
    question: "¿Puedes trabajar en diferentes zonas horarias?",
    answer:
      "Sí. Estoy ubicado en Barcelona (CET/CEST) y tengo experiencia colaborando con equipos en Europa y América. Soy flexible con mi horario y puedo adaptarme a las horas de solapamiento con tu equipo. He trabajado con equipos distribuidos y entiendo la importancia de la comunicación asíncrona.",
  },
  {
    question: "¿Cómo es tu equipo o proyecto ideal?",
    answer:
      "Me desenvuelvo mejor en equipos enfocados en producto que valoran el código limpio, las code reviews y la mejora continua. Disfruto trabajando con equipos que usan prácticas modernas como Git flow, CI/CD y metodologías ágiles. Soy más efectivo cuando puedo asumir features end-to-end, desde base de datos hasta UI, y colaborar estrechamente con diseñadores y product managers.",
  },
  {
    question: "¿Cómo gestionas la comunicación remota?",
    answer:
      "Mantengo actualizaciones asíncronas diarias, estoy disponible en Slack o Teams durante las horas de solapamiento y documento mi trabajo de forma clara. Soy proactivo reportando bloqueos, haciendo preguntas cuando los requisitos no están claros y compartiendo avances. Llevo trabajando en remoto desde 2019 y he refinado un flujo de trabajo que mantiene a los equipos alineados sin reuniones innecesarias.",
  },
  {
    question: "¿Cómo es tu proceso de onboarding?",
    answer:
      "Normalmente soy productivo dentro de la primera semana. Empiezo leyendo la documentación existente, entendiendo la arquitectura del código y configurando el entorno de desarrollo local. Prefiero coger una tarea pequeña pronto para familiarizarme con el proceso de code review y las convenciones del equipo. Para la segunda semana, suelo estar contribuyendo al trabajo regular del sprint.",
  },
  {
    question: "¿Estás abierto a trabajo presencial o híbrido?",
    answer:
      "Prefiero el trabajo 100% remoto, pero estoy abierto a visitas presenciales ocasionales o acuerdos híbridos dentro de Europa. Creo que el mejor trabajo ocurre cuando los desarrolladores tienen la flexibilidad de concentrarse sin interrupciones, combinado con colaboración presencial periódica para team building y planificación estratégica.",
  },
];

const questions = isEnglish ? questionsEN : questionsES;

const faqItems = questions.map((item) => ({
  question: item.question,
  answer: item.answer,
}));
---

<div>
  <FAQSchema items={faqItems} />

  <div class="space-y-3 md:space-y-4 max-w-4xl mx-auto px-4 md:px-0">
    {
      questions.map((item) => (
        <div class="border border-gray-300 dark:border-gray-700 rounded-lg overflow-hidden bg-white dark:bg-gray-800 shadow-sm">
          <details class="group">
            <summary class="flex items-center justify-between px-3 md:px-4 py-4 md:py-5 cursor-pointer bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
              <h3 class="text-base md:text-lg font-medium text-gray-900 dark:text-white pr-2">{item.question}</h3>
              <span class="relative ml-1.5 flex-shrink-0 w-5 h-5">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="absolute inset-0 w-5 h-5 opacity-100 group-open:opacity-0 transition-opacity text-gray-700 dark:text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  />
                </svg>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="absolute inset-0 w-5 h-5 opacity-0 group-open:opacity-100 transition-opacity text-gray-700 dark:text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M18 12H6"
                  />
                </svg>
              </span>
            </summary>
            <div class="px-3 md:px-4 py-4 md:py-5 border-t border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 transition-all duration-300 overflow-hidden">
              <p class="text-gray-700 dark:text-gray-300 text-sm md:text-base leading-relaxed">{item.answer}</p>
            </div>
          </details>
        </div>
      ))
    }
  </div>
</div>

<style>
  details summary::-webkit-details-marker {
    display: none;
  }

  details summary {
    list-style: none;
  }

  details > div {
    max-height: 0;
    opacity: 0;
    transition:
      max-height 0.3s ease,
      opacity 0.3s ease,
      padding 0.3s ease;
  }

  details[open] > div {
    max-height: 1000px;
    opacity: 1;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const details = document.querySelectorAll("details");

    details.forEach((detail) => {
      detail.addEventListener("toggle", () => {
        const content = detail.querySelector("div");
        if (!content) return;

        if (detail.open) {
          content.style.maxHeight = content.scrollHeight + "px";
          content.style.opacity = "1";
          setTimeout(() => {
            content.style.maxHeight = "none";
          }, 300);
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          requestAnimationFrame(() => {
            content.style.maxHeight = "0";
            content.style.opacity = "0";
          });
        }
      });
    });
  });
</script>

